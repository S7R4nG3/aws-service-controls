{
    "service": "AWS VPC Security Group",
    "security": [
        {
            "name": "CSA Cloud Controls Matrix",
            "version": "v5.0",
            "controls": [
                {
                    "identifier": "IAM-01",
                    "title": "Identity and Access Management Policy",
                    "severity": "Critical",
                    "description": "Establish comprehensive identity and access management policies for security group management",
                    "implementation": {
                        "type": "Platform",
                        "description": "Configure IAM policies with principle of least privilege for security group operations, implement resource-based policies and conditions"
                    }
                },
                {
                    "identifier": "IAM-02",
                    "title": "User Access Provisioning",
                    "severity": "High",
                    "description": "Implement proper user access provisioning and deprovisioning procedures",
                    "implementation": {
                        "type": "Platform",
                        "description": "Use IAM roles and groups for security group access, implement automated provisioning workflows"
                    }
                },
                {
                    "identifier": "IVS-01",
                    "title": "Network Architecture",
                    "severity": "Critical",
                    "description": "Design secure network architecture with proper segmentation",
                    "implementation": {
                        "type": "IaC",
                        "description": "Define security groups in IaC templates with proper rule definitions and network segmentation patterns"
                    }
                },
                {
                    "identifier": "IVS-02",
                    "title": "Network Controls",
                    "severity": "High",
                    "description": "Implement network security controls including firewalls and access controls",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure security group rules to deny by default, allow only necessary traffic, implement layered security"
                    }
                },
                {
                    "identifier": "LOG-01",
                    "title": "Logging and Monitoring",
                    "severity": "High",
                    "description": "Implement comprehensive logging and monitoring for security events",
                    "implementation": {
                        "type": "Platform",
                        "description": "Enable CloudTrail for security group changes, implement VPC Flow Logs, configure monitoring dashboards"
                    }
                },
                {
                    "identifier": "BCR-01",
                    "title": "Business Continuity Management",
                    "severity": "Medium",
                    "description": "Ensure business continuity through proper backup and recovery procedures",
                    "implementation": {
                        "type": "IaC",
                        "description": "Implement security group configurations in version-controlled IaC templates for disaster recovery"
                    }
                }
            ]
        },
        {
            "name": "NIST SP 800-53",
            "version": "Rev 5",
            "controls": [
                {
                    "identifier": "AC-3",
                    "title": "Access Enforcement",
                    "severity": "Critical",
                    "description": "Enforce approved authorizations for logical access to information and system resources",
                    "implementation": {
                        "type": "Platform",
                        "description": "Configure IAM policies to enforce least privilege access to security group management functions"
                    }
                },
                {
                    "identifier": "AC-4",
                    "title": "Information Flow Enforcement",
                    "severity": "Critical",
                    "description": "Control information flows within the system and between interconnected systems",
                    "implementation": {
                        "type": "IaC",
                        "description": "Design security group rules to enforce information flow policies between network segments"
                    }
                },
                {
                    "identifier": "AU-2",
                    "title": "Event Logging",
                    "severity": "High",
                    "description": "Identify the types of events that the system is capable of logging",
                    "implementation": {
                        "type": "Platform",
                        "description": "Enable CloudTrail logging for all security group API calls and configuration changes"
                    }
                },
                {
                    "identifier": "AU-6",
                    "title": "Audit Record Review, Analysis, and Reporting",
                    "severity": "High",
                    "description": "Review and analyze information system audit records for indications of inappropriate or unusual activity",
                    "implementation": {
                        "type": "User",
                        "description": "Implement regular review processes for security group changes and access patterns using CloudWatch and Security Hub"
                    }
                },
                {
                    "identifier": "CM-2",
                    "title": "Baseline Configuration",
                    "severity": "High",
                    "description": "Develop, document, and maintain a current baseline configuration",
                    "implementation": {
                        "type": "IaC",
                        "description": "Maintain baseline security group configurations in version-controlled IaC templates"
                    }
                },
                {
                    "identifier": "CM-6",
                    "title": "Configuration Settings",
                    "severity": "Medium",
                    "description": "Establish and document configuration settings for system components",
                    "implementation": {
                        "type": "IaC",
                        "description": "Document and standardize security group configuration settings in organizational templates"
                    }
                },
                {
                    "identifier": "CP-9",
                    "title": "System Backup",
                    "severity": "Medium",
                    "description": "Conduct backups of user-level information contained in the system",
                    "implementation": {
                        "type": "Platform",
                        "description": "Implement automated backup of security group configurations using AWS Config and IaC state management"
                    }
                }
            ]
        },
        {
            "name": "AWS Foundational Security Best Practices",
            "version": "1.0",
            "controls": [
                {
                    "identifier": "EC2.1",
                    "title": "Amazon EBS snapshots should not be public",
                    "severity": "Critical",
                    "description": "Ensure EBS snapshots are not publicly accessible",
                    "implementation": {
                        "type": "Platform",
                        "description": "Configure security groups to restrict access to EBS resources and implement proper snapshot policies"
                    }
                },
                {
                    "identifier": "EC2.2",
                    "title": "VPC default security group should not allow inbound and outbound traffic",
                    "severity": "Critical",
                    "description": "Default security groups should restrict all traffic",
                    "implementation": {
                        "type": "IaC",
                        "description": "Remove all inbound and outbound rules from default security groups, create custom security groups for specific needs"
                    }
                },
                {
                    "identifier": "EC2.19",
                    "title": "Security groups should not allow unrestricted access to ports with high risk",
                    "severity": "Critical",
                    "description": "Restrict access to high-risk ports like SSH, RDP, and database ports",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure security group rules to allow access only from specific IP ranges or security groups for high-risk ports"
                    }
                },
                {
                    "identifier": "EC2.20",
                    "title": "Both VPC default security groups should not allow inbound and outbound traffic",
                    "severity": "High",
                    "description": "Ensure both default security groups in VPC restrict all traffic",
                    "implementation": {
                        "type": "IaC",
                        "description": "Systematically review and remove all rules from default security groups across all VPCs"
                    }
                },
                {
                    "identifier": "EC2.21",
                    "title": "Network ACLs should not allow ingress from 0.0.0.0/0 to port 22 or 3389",
                    "severity": "High",
                    "description": "Restrict SSH and RDP access in network ACLs",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure security groups to complement NACL restrictions for administrative access ports"
                    }
                },
                {
                    "identifier": "Config.1",
                    "title": "AWS Config should be enabled",
                    "severity": "Medium",
                    "description": "Enable AWS Config to track security group configuration changes",
                    "implementation": {
                        "type": "Platform",
                        "description": "Enable AWS Config in all regions to monitor security group configuration compliance"
                    }
                }
            ]
        },
        {
            "name": "AWS Security Hub",
            "version": "Current",
            "controls": [
                {
                    "identifier": "SecurityHub.EC2.1",
                    "title": "Security groups should not allow unrestricted inbound traffic",
                    "severity": "Critical",
                    "description": "Security groups should not have inbound rules that allow unrestricted traffic",
                    "implementation": {
                        "type": "IaC",
                        "description": "Review and restrict security group rules to allow only necessary traffic from specific sources"
                    }
                },
                {
                    "identifier": "SecurityHub.EC2.2",
                    "title": "Security groups should not allow unrestricted outbound traffic",
                    "severity": "High",
                    "description": "Security groups should have restrictive outbound rules",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure explicit outbound rules instead of allowing all outbound traffic"
                    }
                },
                {
                    "identifier": "SecurityHub.CloudTrail.1",
                    "title": "CloudTrail should be enabled",
                    "severity": "High",
                    "description": "Enable CloudTrail to log security group API calls",
                    "implementation": {
                        "type": "Platform",
                        "description": "Enable CloudTrail across all regions to capture security group management activities"
                    }
                },
                {
                    "identifier": "SecurityHub.Config.1",
                    "title": "AWS Config should be enabled",
                    "severity": "Medium",
                    "description": "Enable AWS Config for compliance monitoring",
                    "implementation": {
                        "type": "Platform",
                        "description": "Configure AWS Config rules to monitor security group compliance with organizational policies"
                    }
                },
                {
                    "identifier": "SecurityHub.IAM.1",
                    "title": "IAM policies should not allow full administrative privileges",
                    "severity": "High",
                    "description": "Restrict IAM policies for security group management to necessary permissions only",
                    "implementation": {
                        "type": "Platform",
                        "description": "Create specific IAM policies for security group management with least privilege principles"
                    }
                }
            ]
        }
    ],
    "operational": [],
    "cost": [
        {
            "name": "AWS VPC Security Group Cost Optimization",
            "version": "Best Practices",
            "controls": [
                {
                    "identifier": "COST-01",
                    "title": "Optimize Security Group Usage",
                    "severity": "High",
                    "description": "Eliminate unused and redundant security groups to reduce management overhead",
                    "implementation": {
                        "type": "User",
                        "description": "Regularly audit and remove unused security groups, consolidate similar security groups where appropriate"
                    }
                },
                {
                    "identifier": "COST-02",
                    "title": "Implement Efficient Rule Management",
                    "severity": "Medium",
                    "description": "Optimize security group rules to reduce complexity and management costs",
                    "implementation": {
                        "type": "IaC",
                        "description": "Use security group references instead of IP addresses where possible, implement rule consolidation strategies"
                    }
                },
                {
                    "identifier": "COST-03",
                    "title": "Automate Security Group Management",
                    "severity": "Medium",
                    "description": "Reduce operational costs through automation of security group lifecycle management",
                    "implementation": {
                        "type": "Platform",
                        "description": "Implement automated security group provisioning and deprovisioning using IaC and AWS Lambda functions"
                    }
                },
                {
                    "identifier": "COST-04",
                    "title": "Monitor Security Group Utilization",
                    "severity": "Low",
                    "description": "Track security group usage to identify cost optimization opportunities",
                    "implementation": {
                        "type": "Platform",
                        "description": "Use AWS Cost Explorer and custom CloudWatch metrics to monitor security group-related costs and usage patterns"
                    }
                },
                {
                    "identifier": "COST-05",
                    "title": "Implement Tagging Strategy",
                    "severity": "Low",
                    "description": "Use consistent tagging for cost allocation and management",
                    "implementation": {
                        "type": "IaC",
                        "description": "Apply consistent cost allocation tags to security groups for better cost tracking and chargeback processes"
                    }
                }
            ]
        }
    ]
}