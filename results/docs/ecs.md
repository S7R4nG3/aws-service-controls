# AWS Elastic Container Service (ECS)
---

| Severity | Identifier | Framework | Title | Description | Implementation | Code |
| - | - | - | - | - | - | - |
| **High** | AC-2 | NIST 800-53 Rev 5 | Account Management | Manage system accounts, group memberships, privileges, workflow, notifications, deactivations, and authorizations | **Platform** - Implement IAM roles and policies for ECS services, tasks, and users with principle of least privilege |  |
| **High** | AC-3 | NIST 800-53 Rev 5 | Access Enforcement | Enforce approved authorizations for logical access to information and system resources | **IaC** - Define IAM policies in CloudFormation/Terraform templates that restrict ECS API access and task execution permissions |  |
| **High** | SC-7 | NIST 800-53 Rev 5 | Boundary Protection | Monitor and control communications at the external boundary of the system and at key internal boundaries | **IaC** - Configure VPC security groups, NACLs, and Application Load Balancer security groups for ECS services |  |
| **High** | SC-8 | NIST 800-53 Rev 5 | Transmission Confidentiality and Integrity | Protect the confidentiality and integrity of transmitted information | **IaC** - Enable TLS encryption for ECS service communication and configure SSL/TLS certificates on load balancers |  |
| Medium | AU-2 | NIST 800-53 Rev 5 | Audit Events | Identify the types of events that the system is capable of logging and that the organization wants logged | **Platform** - Enable CloudTrail logging for ECS API calls and configure container insights for application logging |  |
| Medium | AU-6 | NIST 800-53 Rev 5 | Audit Record Review, Analysis, and Reporting | Review and analyze system audit records for indications of inappropriate or unusual activity | **Platform** - Set up CloudWatch monitoring and alerts for ECS service metrics and security events |  |
| Medium | CM-2 | NIST 800-53 Rev 5 | Baseline Configuration | Develop, document, and maintain a current baseline configuration of the system | **IaC** - Use standardized ECS task definitions and container images with version control and configuration management |  |
| Medium | RA-5 | NIST 800-53 Rev 5 | Vulnerability Monitoring and Scanning | Monitor and scan for vulnerabilities in the system and hosted applications and update the vulnerability scanning activities when new vulnerabilities are identified | **Platform** - Enable Amazon Inspector for ECS container vulnerability assessments and ECR image scanning |  |
| **High** | IAM-01 | CSA Cloud Controls Matrix v4.0 | Identity and Access Management Policy | Policies and procedures shall be established for the full lifecycle of identity and access management | **User** - Develop and implement IAM policies specific to ECS resource access and container execution roles |  |
| **High** | IAM-02 | CSA Cloud Controls Matrix v4.0 | User Access Authorization | User access policies and procedures shall be established and maintained for all systems and services | **Platform** - Configure ECS task roles and execution roles with minimal required permissions for container operations |  |
| **High** | DSI-01 | CSA Cloud Controls Matrix v4.0 | Data Security and Information Lifecycle Management | Policies and procedures shall be established for data security and information lifecycle management | **User** - Classify data processed by ECS containers and implement appropriate security controls based on classification |  |
| **High** | EKM-01 | CSA Cloud Controls Matrix v4.0 | Encryption and Key Management | Encryption and key management policies and procedures shall be established and maintained | **Platform** - Use AWS KMS for encrypting ECS task data, EBS volumes, and secrets management with proper key rotation |  |
| Medium | LOG-01 | CSA Cloud Controls Matrix v4.0 | Logging and Monitoring Policy | Logging and monitoring policies and procedures shall be established and maintained | **IaC** - Configure centralized logging for ECS containers using CloudWatch Logs or third-party solutions |  |
| Medium | IPY-01 | CSA Cloud Controls Matrix v4.0 | Network Infrastructure Protection | Network security controls shall be implemented to protect the service provider network infrastructure | **IaC** - Implement network segmentation for ECS services using VPC subnets and security groups |  |
| Medium | BCR-01 | CSA Cloud Controls Matrix v4.0 | Business Continuity Management and Operational Resilience | Business continuity and operational resilience procedures shall be established and maintained | **IaC** - Deploy ECS services across multiple Availability Zones with appropriate auto-scaling policies |  |
| Low | STA-01 | CSA Cloud Controls Matrix v4.0 | Secure Software Development Lifecycle | Policies and procedures shall be established for secure application development and deployment | **User** - Implement secure container image building practices and vulnerability scanning in CI/CD pipelines |  |
| **High** | ECS.1 | AWS Foundational Security Best Practices 1.0.0 | Amazon ECS task definitions should not share the host's process namespace | ECS task definitions should not share the host's process namespace to maintain container isolation | **IaC** - Set pidMode to 'task' or omit pidMode parameter in ECS task definitions to avoid sharing host process namespace |  |
| **High** | ECS.2 | AWS Foundational Security Best Practices 1.0.0 | ECS services should not have public IP addresses assigned automatically | ECS services should not automatically assign public IP addresses unless required for internet access | **IaC** - Set assignPublicIp to 'DISABLED' in ECS service network configuration and use NAT Gateway for outbound internet access |  |
| **High** | ECS.3 | AWS Foundational Security Best Practices 1.0.0 | ECS task definitions should not share the host's network namespace | ECS task definitions should use awsvpc network mode instead of host network mode | **IaC** - Configure networkMode to 'awsvpc' in ECS task definitions to provide network isolation |  |
| **High** | ECS.4 | AWS Foundational Security Best Practices 1.0.0 | ECS containers should run as non-privileged | ECS containers should not run with privileged access to the host | **IaC** - Set privileged to false in container definitions and avoid running containers as root user |  |
| **High** | ECS.8 | AWS Foundational Security Best Practices 1.0.0 | Secrets should not be passed as container environment variables | ECS task definitions should use secrets manager or parameter store instead of environment variables for sensitive data | **IaC** - Use secrets parameter in container definitions to reference AWS Secrets Manager or Systems Manager Parameter Store |  |
| Medium | ECS.5 | AWS Foundational Security Best Practices 1.0.0 | ECS containers should limit memory usage | ECS container definitions should specify memory limits to prevent resource exhaustion | **IaC** - Define memory and memoryReservation parameters in ECS container definitions to limit resource usage |  |
| Medium | ECS.10 | AWS Foundational Security Best Practices 1.0.0 | ECS Fargate services should run on the latest Fargate platform version | ECS Fargate services should use the latest platform version for security updates | **Platform** - Specify platformVersion as 'LATEST' or specific latest version in ECS Fargate service configuration |  |
| Low | ECS.12 | AWS Foundational Security Best Practices 1.0.0 | ECS clusters should use Container Insights | ECS clusters should have Container Insights enabled for monitoring and logging | **Platform** - Enable Container Insights on ECS clusters through AWS CLI or console for enhanced monitoring capabilities |  |
| **High** | ECS.1 | AWS Security Hub 2024 | Amazon ECS task definitions should not share the host's process namespace | This control checks whether Amazon ECS task definitions are configured to share a host's process namespace | **IaC** - Ensure pidMode is not set to 'host' in ECS task definitions to maintain process isolation |  |
| **High** | ECS.2 | AWS Security Hub 2024 | ECS services should not have public IP addresses assigned automatically | This control checks whether Amazon ECS services are configured to automatically assign public IP addresses | **IaC** - Configure ECS services with assignPublicIp set to 'DISABLED' in private subnets with NAT Gateway access |  |
| **High** | ECS.4 | AWS Security Hub 2024 | ECS containers should run as non-privileged | This control checks if the privileged parameter in the container definition of ECS Task Definitions is set to true | **IaC** - Set privileged to false in ECS container definitions and implement least privilege access |  |
| **High** | ECS.8 | AWS Security Hub 2024 | Secrets should not be passed as container environment variables | This control checks whether Amazon ECS task definitions have secrets passed as environment variables | **IaC** - Use AWS Secrets Manager or Systems Manager Parameter Store with secrets configuration instead of environment variables |  |
| Medium | ECS.3 | AWS Security Hub 2024 | ECS task definitions should not share the host's network namespace | This control checks if Amazon ECS task definitions have host networking mode configured | **IaC** - Use 'awsvpc' network mode instead of 'host' network mode in ECS task definitions |  |
| Medium | ECS.5 | AWS Security Hub 2024 | ECS containers should limit memory usage | This control checks if Amazon ECS containers have memory usage limits defined | **IaC** - Define memory limits in ECS container definitions to prevent resource exhaustion and improve stability |  |
| Medium | ECS.10 | AWS Security Hub 2024 | ECS Fargate services should run on the latest Fargate platform version | This control checks if Amazon ECS Fargate services are running the latest Fargate platform version | **Platform** - Regularly update ECS Fargate services to use the latest platform version for security patches and improvements |  |
| Low | ECS.12 | AWS Security Hub 2024 | ECS clusters should use Container Insights | This control checks if ECS clusters use Container Insights | **Platform** - Enable Container Insights on ECS clusters for comprehensive monitoring and observability |  |

## Operational Controls
---



## Cost Controls
---

| Severity | Identifier | Framework | Title | Description | Implementation | Code |
| - | - | - | - | - | - | - |
| **High** | COST-01 | AWS ECS Cost Optimization Best Practices 2024 | Right-size ECS Tasks and Services | Optimize CPU and memory allocation for ECS tasks to avoid over-provisioning resources | **Platform** - Monitor CloudWatch Container Insights metrics to right-size CPU and memory allocation, and use AWS Compute Optimizer recommendations |  |
| **High** | COST-02 | AWS ECS Cost Optimization Best Practices 2024 | Use Fargate Spot for Fault-Tolerant Workloads | Utilize Fargate Spot pricing for cost-sensitive and fault-tolerant workloads to reduce compute costs by up to 70% | **IaC** - Configure ECS services with capacityProviders including FARGATE_SPOT with appropriate capacity provider strategies |  |
| **High** | COST-03 | AWS ECS Cost Optimization Best Practices 2024 | Implement Auto Scaling | Configure ECS service auto scaling and cluster auto scaling to match resource demand dynamically | **IaC** - Set up Application Auto Scaling policies for ECS services based on CPU, memory, or custom metrics to scale automatically |  |
| Medium | COST-04 | AWS ECS Cost Optimization Best Practices 2024 | Use EC2 Spot Instances for ECS Clusters | Leverage EC2 Spot Instances in ECS clusters for significant cost savings on fault-tolerant workloads | **IaC** - Configure ECS Capacity Providers with EC2 Auto Scaling Groups using Spot Instances and mixed instance types |  |
| Medium | COST-05 | AWS ECS Cost Optimization Best Practices 2024 | Optimize Container Images | Minimize container image sizes to reduce storage costs and improve deployment times | **User** - Use multi-stage Docker builds, minimal base images, and remove unnecessary packages to reduce image size and ECR storage costs |  |
| Medium | COST-06 | AWS ECS Cost Optimization Best Practices 2024 | Implement Resource-Based Scheduling | Use task placement strategies to optimize resource utilization across ECS container instances | **IaC** - Configure placement strategies like 'binpack' to maximize resource utilization and reduce the number of required instances |  |
| Medium | COST-07 | AWS ECS Cost Optimization Best Practices 2024 | Monitor and Optimize Data Transfer Costs | Minimize data transfer costs by optimizing network architecture and data flow patterns | **IaC** - Deploy ECS services in same AZ when possible, use VPC endpoints for AWS services, and implement data locality strategies |  |
| Low | COST-08 | AWS ECS Cost Optimization Best Practices 2024 | Use Reserved Capacity for Predictable Workloads | Purchase EC2 Reserved Instances or Savings Plans for predictable ECS workloads running on EC2 launch type | **Platform** - Analyze usage patterns and purchase Reserved Instances or Compute Savings Plans for consistent ECS workloads on EC2 |  |

