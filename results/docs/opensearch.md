# AWS OpenSearch
---

| Severity | Identifier | Framework | Title | Description | Implementation | Code |
| - | - | - | - | - | - | - |
| **Critical** | IAM-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Entitlement | Policies and procedures shall be established to govern the assignment of privileges associated with OpenSearch service access | **IaC** - Implement IAM policies through CloudFormation/Terraform templates defining role-based access controls for OpenSearch domains |  |
| **Critical** | DSI-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Data Classification | Policies and procedures shall be established for classifying data stored in OpenSearch based on sensitivity, criticality, and business value | **IaC** - Define index lifecycle management policies and data retention rules in OpenSearch configuration templates |  |
| **Critical** | EKM-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Encryption | Policies and procedures shall be established for the use of encryption to protect data at rest and in transit in OpenSearch | **Platform** - Enable encryption at rest using AWS KMS and enforce HTTPS/TLS for all communications |  |
| **High** | IAM-02 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | User Access Management | Policies and procedures shall be established to govern user access provisioning and de-provisioning for OpenSearch clusters | **Platform** - Configure fine-grained access control with AWS IAM integration and OpenSearch native authentication |  |
| **High** | IVS-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Network Architecture | Network security architecture shall be designed and implemented to protect OpenSearch infrastructure | **IaC** - Deploy OpenSearch in private subnets with VPC security groups and NACLs configured through infrastructure templates |  |
| Medium | BCR-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Business Continuity Planning | Business continuity planning shall be implemented to ensure the availability of OpenSearch services during disruptions | **Platform** - Configure automated snapshots to S3 and cross-region replication for critical OpenSearch domains |  |
| **Critical** | AC-2 | NIST Special Publication 800-53 Rev. 5 | Account Management | Manage OpenSearch user accounts including creation, enabling, modification, disabling, and removal | **User** - Establish procedures for managing OpenSearch user accounts through AWS IAM and internal user databases |  |
| **Critical** | AC-3 | NIST Special Publication 800-53 Rev. 5 | Access Enforcement | Enforce approved authorizations for logical access to OpenSearch resources | **Platform** - Configure fine-grained access control policies and resource-based permissions in OpenSearch |  |
| **Critical** | SC-8 | NIST Special Publication 800-53 Rev. 5 | Transmission Confidentiality and Integrity | Protect the confidentiality and integrity of transmitted information to and from OpenSearch | **Platform** - Enable TLS encryption for all OpenSearch communications and configure certificate validation |  |
| **Critical** | SC-28 | NIST Special Publication 800-53 Rev. 5 | Protection of Information at Rest | Protect the confidentiality and integrity of information at rest in OpenSearch | **Platform** - Enable encryption at rest using AWS KMS customer-managed keys for OpenSearch domains |  |
| **High** | AU-2 | NIST Special Publication 800-53 Rev. 5 | Event Logging | Identify the types of events to be logged by OpenSearch | **IaC** - Configure OpenSearch audit logging and integrate with CloudWatch Logs through infrastructure templates |  |
| **High** | SI-4 | NIST Special Publication 800-53 Rev. 5 | System Monitoring | Monitor the OpenSearch system to detect attacks and indicators of potential attacks | **Platform** - Enable CloudWatch monitoring and set up CloudTrail logging for OpenSearch API calls |  |
| Medium | CP-9 | NIST Special Publication 800-53 Rev. 5 | System Backup | Conduct backups of OpenSearch data and system-level information | **IaC** - Implement automated snapshot policies and cross-region backup strategies in OpenSearch configuration |  |
| **Critical** | OpenSearch.1 | AWS Foundational Security Best Practices 1.0.0 | OpenSearch domains should have encryption at rest enabled | OpenSearch domains must use encryption at rest to protect sensitive data | **Platform** - Enable encryption at rest when creating OpenSearch domains through AWS console or API |  |
| **Critical** | OpenSearch.2 | AWS Foundational Security Best Practices 1.0.0 | OpenSearch domains should not be publicly accessible | OpenSearch domains should be configured to prevent public access | **IaC** - Configure VPC-based access and restrict public access policies in OpenSearch domain configuration |  |
| **Critical** | OpenSearch.3 | AWS Foundational Security Best Practices 1.0.0 | OpenSearch domains should encrypt data sent between nodes | Enable node-to-node encryption for OpenSearch domains | **Platform** - Enable node-to-node encryption setting when configuring OpenSearch domain security |  |
| **High** | OpenSearch.4 | AWS Foundational Security Best Practices 1.0.0 | OpenSearch domain error logging to CloudWatch Logs should be enabled | Enable error logging to CloudWatch Logs for monitoring and troubleshooting | **Platform** - Configure CloudWatch Logs integration for OpenSearch error logs in domain settings |  |
| **High** | OpenSearch.5 | AWS Foundational Security Best Practices 1.0.0 | OpenSearch domains should have audit logging enabled | Enable audit logging to track access and changes to OpenSearch domains | **Platform** - Enable audit logs in OpenSearch fine-grained access control settings |  |
| **High** | OpenSearch.7 | AWS Foundational Security Best Practices 1.0.0 | OpenSearch domains should have fine-grained access control enabled | Enable fine-grained access control for enhanced security | **Platform** - Enable fine-grained access control with internal user database or SAML authentication |  |
| Medium | OpenSearch.6 | AWS Foundational Security Best Practices 1.0.0 | OpenSearch domains should have at least three data nodes | Ensure high availability by configuring at least three data nodes | **IaC** - Configure cluster with minimum three data nodes across multiple AZs in infrastructure templates |  |
| **Critical** | OpenSearch.8 | AWS Security Hub 2.0 | Connections to OpenSearch domains should be encrypted using TLS 1.2 | Enforce TLS 1.2 or higher for all connections to OpenSearch domains | **Platform** - Configure TLS security policy to enforce minimum TLS 1.2 in OpenSearch domain settings |  |
| **High** | OpenSearch.9 | AWS Security Hub 2.0 | OpenSearch domains should have automatic software update enabled | Enable automatic software updates to ensure security patches are applied | **Platform** - Enable service software update settings in OpenSearch domain configuration |  |
| Medium | OpenSearch.10 | AWS Security Hub 2.0 | OpenSearch domains should not use deprecated instance types | Use current generation instance types for better security and performance | **IaC** - Specify current generation instance types (m6g, r6g, etc.) in OpenSearch domain templates |  |

## Operational Controls
---



## Cost Controls
---

| Severity | Identifier | Framework | Title | Description | Implementation | Code |
| - | - | - | - | - | - | - |
| **High** | COST-01 | AWS OpenSearch Cost Optimization Best Practices 2024 | Right-size OpenSearch instances | Monitor and adjust instance types and sizes based on actual usage patterns | **User** - Regularly review CloudWatch metrics and use AWS Compute Optimizer recommendations to right-size instances |  |
| **High** | COST-02 | AWS OpenSearch Cost Optimization Best Practices 2024 | Implement UltraWarm storage for infrequently accessed data | Move older, less frequently accessed data to UltraWarm storage to reduce costs | **Platform** - Configure UltraWarm nodes and implement index state management policies to automatically transition data |  |
| **High** | COST-03 | AWS OpenSearch Cost Optimization Best Practices 2024 | Use Reserved Instances for predictable workloads | Purchase Reserved Instances for stable, long-running OpenSearch workloads | **User** - Analyze usage patterns and purchase 1-year or 3-year Reserved Instances for consistent workloads |  |
| **High** | COST-04 | AWS OpenSearch Cost Optimization Best Practices 2024 | Optimize data retention and lifecycle policies | Implement data lifecycle management to automatically delete or archive old data | **IaC** - Configure Index State Management policies to automatically delete indices after specified retention periods |  |
| Medium | COST-05 | AWS OpenSearch Cost Optimization Best Practices 2024 | Monitor and set up cost alerting | Implement cost monitoring and alerting to track OpenSearch spending | **Platform** - Set up AWS Budgets and Cost Anomaly Detection for OpenSearch service costs |  |
| Medium | COST-06 | AWS OpenSearch Cost Optimization Best Practices 2024 | Optimize shard size and count | Configure appropriate shard sizes to optimize storage and compute costs | **User** - Design indices with optimal shard sizes (10-50GB per shard) and avoid over-sharding |  |
| Medium | COST-07 | AWS OpenSearch Cost Optimization Best Practices 2024 | Use appropriate storage types | Select cost-effective storage types based on performance requirements | **IaC** - Choose gp3 over gp2 EBS volumes where appropriate and configure Cold storage for archival data |  |
| Medium | COST-08 | AWS OpenSearch Cost Optimization Best Practices 2024 | Implement cluster auto-scaling | Use auto-scaling to automatically adjust cluster size based on demand | **Platform** - Enable auto-scaling for OpenSearch domains to automatically scale up/down based on utilization metrics |  |
| Low | COST-09 | AWS OpenSearch Cost Optimization Best Practices 2024 | Regular cleanup of unused resources | Regularly identify and remove unused indices, snapshots, and domains | **User** - Implement regular audits to identify and clean up unused OpenSearch resources and old snapshots |  |
| Low | COST-10 | AWS OpenSearch Cost Optimization Best Practices 2024 | Optimize cross-AZ data transfer | Minimize cross-AZ data transfer costs through proper cluster design | **IaC** - Configure zone awareness and replica placement to minimize cross-AZ data transfer |  |

