# AWS VPC Security Group
---

| Severity | Identifier | Framework | Title | Description | Implementation | Code |
| - | - | - | - | - | - | - |
| **High** | IAM-01 | CSA CCM v4.0.10 | Identity and Access Management Policy and Procedures | Establish formal identity and access management policies for security group management | **Platform** - Configure IAM policies with least privilege principles for security group creation, modification, and deletion. Use IAM roles and groups to manage access to security group operations. |  |
| **High** | IVS-01 | CSA CCM v4.0.10 | Network Architecture | Implement secure network architecture through proper security group configuration | **IaC** - Define security groups in Infrastructure as Code templates with explicit ingress and egress rules, avoiding overly permissive configurations like 0.0.0.0/0 for sensitive services. |  |
| **High** | IVS-06 | CSA CCM v4.0.10 | Network Security | Ensure network security controls are properly implemented and monitored | **Platform** - Configure security groups with deny-by-default stance, implement rule-based access controls, and regularly audit security group configurations for compliance. |  |
| Medium | LOG-01 | CSA CCM v4.0.10 | Audit Logging Policy and Procedures | Establish comprehensive logging for security group changes and access | **Platform** - Enable AWS CloudTrail to log all security group API calls, configure VPC Flow Logs to monitor traffic patterns, and establish log retention policies. |  |
| Medium | BCR-01 | CSA CCM v4.0.10 | Business Continuity Management and Operational Resilience | Ensure security group configurations support business continuity requirements | **IaC** - Implement cross-region security group template replication, automate security group backup and restoration procedures, and document recovery processes. |  |
| **High** | AC-3 | NIST 800-53 Rev 5 | Access Enforcement | Enforce approved authorizations for logical access to security group management | **Platform** - Implement IAM policies that restrict security group management to authorized personnel only, using condition keys to limit actions based on source IP, time, and MFA requirements. |  |
| **High** | CM-2 | NIST 800-53 Rev 5 | Baseline Configuration | Develop, document, and maintain baseline configurations for security groups | **IaC** - Create standardized security group templates in Infrastructure as Code, implement configuration management processes, and establish approved baseline configurations for different workload types. |  |
| **High** | SC-7 | NIST 800-53 Rev 5 | Boundary Protection | Monitor and control communications at external boundaries and key internal boundaries | **IaC** - Configure security groups as stateful firewalls with explicit allow rules, implement layered security with both security groups and NACLs, and establish clear network segmentation boundaries. |  |
| Medium | AU-2 | NIST 800-53 Rev 5 | Event Logging | Identify events for logging and auditing of security group activities | **Platform** - Configure comprehensive logging of security group changes through CloudTrail, implement VPC Flow Logs for traffic analysis, and establish event correlation mechanisms. |  |
| Medium | SI-4 | NIST 800-53 Rev 5 | System Monitoring | Monitor the system to detect attacks and indicators of potential attacks on security groups | **Platform** - Implement automated monitoring for security group configuration changes, set up alerts for unauthorized modifications, and establish baseline traffic patterns for anomaly detection. |  |
| Low | CP-1 | NIST 800-53 Rev 5 | Contingency Planning Policy and Procedures | Develop contingency planning policy and procedures for security group management | **User** - Document security group backup and recovery procedures, establish incident response plans for security group misconfigurations, and create operational runbooks. |  |
| **High** | EC2.2 | AWS Foundational Security Standard 1.0.0 | The VPC default security group should not allow inbound and outbound traffic | Ensure the default security group restricts all traffic | **Platform** - Remove all inbound and outbound rules from the default security group, and ensure no resources are associated with the default security group. |  |
| **High** | EC2.19 | AWS Foundational Security Standard 1.0.0 | Security groups should not allow unrestricted access to ports with high risk | Restrict inbound access to high-risk ports (22, 3389, etc.) in security groups | **IaC** - Configure security groups to restrict SSH (22), RDP (3389), and other administrative ports to specific IP ranges or security groups rather than 0.0.0.0/0. |  |
| Medium | EC2.20 | AWS Foundational Security Standard 1.0.0 | Both VPC default security groups should prohibit inbound and outbound traffic | Ensure both default security groups in VPC restrict all traffic | **Platform** - Audit and remediate default security groups across all VPCs to ensure they have no active rules and no associated resources. |  |
| Medium | EC2.21 | AWS Foundational Security Standard 1.0.0 | Network ACLs should not allow ingress from 0.0.0.0/0 to port 22 or port 3389 | Coordinate security group rules with NACL configurations for layered security | **IaC** - Ensure security group configurations align with NACL restrictions, implementing defense-in-depth for administrative access ports. |  |
| **High** | EC2.2 | AWS Security Hub 2023 | The VPC default security group should not allow inbound and outbound traffic | Default security groups should be configured to deny all traffic | **Platform** - Implement automated compliance checking to ensure default security groups remain empty of rules and associations. |  |
| Medium | EC2.19 | AWS Security Hub 2023 | Security groups should not allow unrestricted access to ports with high risk | Prevent security groups from allowing unrestricted inbound access to high-risk ports | **IaC** - Implement automated scanning of security group rules to identify and remediate overly permissive configurations for high-risk ports. |  |
| Medium | VPC.1 | AWS Security Hub 2023 | Security groups should not allow ingress from 0.0.0.0/0 to port 80 | Restrict HTTP access through security groups to prevent unauthorized web access | **User** - Review and justify any security group rules allowing public HTTP access, implementing Application Load Balancer or CloudFront for public web services instead. |  |
| Low | VPC.2 | AWS Security Hub 2023 | Security groups should not allow ingress from 0.0.0.0/0 to port 443 | Review HTTPS access permissions in security groups | **User** - Regularly audit security groups allowing public HTTPS access and ensure appropriate web application firewall and load balancer configurations are in place. |  |

## Operational Controls
---



## Cost Controls
---

| Severity | Identifier | Framework | Title | Description | Implementation | Code |
| - | - | - | - | - | - | - |
| **High** | COST-01 | AWS VPC Security Group Cost Optimization 2023 | Eliminate Unused Security Groups | Remove security groups that are not associated with any resources to reduce management overhead | **Platform** - Implement automated scanning to identify and remove unused security groups, establish regular cleanup procedures, and maintain inventory of active security groups. |  |
| Medium | COST-02 | AWS VPC Security Group Cost Optimization 2023 | Consolidate Similar Security Groups | Merge security groups with identical or similar rule sets to reduce complexity and management costs | **IaC** - Analyze security group rule patterns, create standardized templates for common use cases, and consolidate redundant security groups through Infrastructure as Code. |  |
| Medium | COST-03 | AWS VPC Security Group Cost Optimization 2023 | Optimize Security Group Rules | Reduce the number of security group rules through efficient rule design and port range optimization | **User** - Review and optimize security group rules by using port ranges instead of individual ports, consolidating similar rules, and removing redundant or overlapping rules. |  |
| Medium | COST-04 | AWS VPC Security Group Cost Optimization 2023 | Use Referenced Security Groups | Reference security groups in rules instead of IP addresses to reduce rule proliferation | **IaC** - Design security group architectures using security group references rather than IP-based rules to enable dynamic scaling without rule multiplication. |  |
| Low | COST-05 | AWS VPC Security Group Cost Optimization 2023 | Implement Automated Security Group Management | Reduce operational costs through automation of security group lifecycle management | **Platform** - Implement automated tools for security group provisioning, monitoring, and cleanup to reduce manual management overhead and associated operational costs. |  |
| Low | COST-06 | AWS VPC Security Group Cost Optimization 2023 | Regular Security Group Auditing | Establish regular auditing processes to maintain optimal security group configurations | **User** - Schedule periodic reviews of security group configurations, document justifications for complex rule sets, and maintain updated documentation to reduce troubleshooting time. |  |

