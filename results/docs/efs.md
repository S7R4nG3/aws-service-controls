# AWS Elastic File System (EFS)
---

| Severity | Identifier | Framework | Title | Description | Implementation | Code |
| - | - | - | - | - | - | - |
| **Critical** | EKM-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Encryption Key Management | Implement proper encryption key management for EFS data at rest and in transit | **Platform** - Configure AWS KMS keys for EFS encryption and enable encryption in transit using TLS |  |
| **Critical** | IAM-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Identity and Access Management Policy and Procedures | Establish, document, approve, communicate, apply, evaluate and maintain policies and procedures for identity and access management for EFS access control | **IaC** - Define IAM policies, roles, and resource-based policies in CloudFormation/Terraform templates to control EFS access |  |
| **High** | DSI-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Data Security and Information Lifecycle Management Policy and Procedures | Establish, document, approve, communicate, apply, evaluate and maintain policies and procedures for data security and information lifecycle management for EFS file systems | **IaC** - Configure EFS lifecycle policies and implement data classification tags through automation |  |
| **High** | IVS-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Infrastructure and Virtualization Security Policy and Procedures | Establish, document, approve, communicate, apply, evaluate and maintain policies and procedures for infrastructure and virtualization security for EFS network infrastructure | **IaC** - Configure VPC security groups, NACLs, and mount target security configurations |  |
| Medium | LOG-01 | Cloud Security Alliance (CSA) Cloud Controls Matrix v4.0 | Audit Logging Policy and Procedures | Establish, document, approve, communicate, apply, evaluate and maintain policies and procedures for audit logging and monitoring for EFS access and operations | **Platform** - Enable CloudTrail, CloudWatch metrics, and VPC Flow Logs for EFS monitoring |  |
| **Critical** | AC-3 | NIST Special Publication 800-53 Rev 5 | Access Enforcement | Enforce approved authorizations for logical access to EFS resources | **IaC** - Implement POSIX permissions, access points, and resource-based policies to enforce access controls |  |
| **Critical** | SC-13 | NIST Special Publication 800-53 Rev 5 | Cryptographic Protection | Implement cryptographic mechanisms to protect EFS data confidentiality and integrity | **Platform** - Enable EFS encryption at rest using AWS KMS and encryption in transit using TLS 1.2 |  |
| **High** | AU-12 | NIST Special Publication 800-53 Rev 5 | Audit Record Generation | Generate audit records for EFS events with defined auditable content | **Platform** - Enable CloudTrail API logging and configure CloudWatch for EFS performance and access monitoring |  |
| **High** | SC-7 | NIST Special Publication 800-53 Rev 5 | Boundary Protection | Monitor and control communications at external boundaries and key internal boundaries | **IaC** - Configure security groups and NACLs to restrict EFS mount target access to authorized networks |  |
| Medium | CP-9 | NIST Special Publication 800-53 Rev 5 | System Backup | Conduct backups of EFS data and system-level information | **Platform** - Configure AWS Backup for automated EFS backups with appropriate retention policies |  |
| Medium | SI-7 | NIST Special Publication 800-53 Rev 5 | Software, Firmware, and Information Integrity | Detect unauthorized changes to EFS configuration and data | **Platform** - Implement AWS Config rules for EFS configuration monitoring and file integrity monitoring |  |
| **Critical** | EFS.1 | AWS Foundational Security Standard 1.0.0 | Amazon EFS should be configured to encrypt file data at rest using AWS KMS | EFS file systems must have encryption at rest enabled to protect sensitive data | **IaC** - Configure EFS with encryption at rest enabled and specify KMS key in infrastructure templates |  |
| **High** | EFS.2 | AWS Foundational Security Standard 1.0.0 | Amazon EFS volumes should be in backup plans | EFS file systems should be included in AWS Backup plans for data protection | **IaC** - Create AWS Backup plans that include EFS resources with appropriate backup frequency and retention |  |
| Medium | EFS.3 | AWS Foundational Security Standard 1.0.0 | EFS access points should enforce a root directory | EFS access points should specify a root directory to limit file system access scope | **IaC** - Configure EFS access points with specific root directory paths and POSIX user mappings |  |
| Medium | EFS.4 | AWS Foundational Security Standard 1.0.0 | EFS access points should enforce a user identity | EFS access points should enforce POSIX user and group identity for secure access | **IaC** - Configure access points with POSIX user ID, group ID, and secondary group mappings |  |
| **Critical** | EFS.1 | AWS Security Hub 2023.1 | Amazon EFS should be configured to encrypt file data at rest using AWS KMS | Ensures EFS file systems have encryption at rest enabled for data protection | **Platform** - Enable EFS encryption at rest during file system creation and manage through AWS KMS |  |
| **High** | EFS.2 | AWS Security Hub 2023.1 | Amazon EFS volumes should be in backup plans | Verifies that EFS file systems are protected by AWS Backup service | **IaC** - Integrate EFS resources into AWS Backup plans with automated backup schedules |  |
| **High** | EFS.6 | AWS Security Hub 2023.1 | EFS mount targets should not be associated with public subnets | Ensures EFS mount targets are deployed in private subnets for network security | **IaC** - Deploy EFS mount targets only in private subnets within VPC architecture |  |
| Medium | EFS.3 | AWS Security Hub 2023.1 | EFS access points should enforce a root directory | Checks that EFS access points limit access to specific directories | **User** - Configure access points through AWS console or CLI with root directory restrictions |  |
| Medium | EFS.4 | AWS Security Hub 2023.1 | EFS access points should enforce a user identity | Validates that access points enforce POSIX user identity for access control | **User** - Set up access points with specific POSIX user and group identity enforcement |  |

## Operational Controls
---



## Cost Controls
---

| Severity | Identifier | Framework | Title | Description | Implementation | Code |
| - | - | - | - | - | - | - |
| **High** | COST-01 | AWS EFS Cost Optimization Best Practices 2023 | Implement EFS Intelligent Tiering | Enable Intelligent Tiering to automatically move files between storage classes based on access patterns | **IaC** - Configure EFS with Intelligent Tiering enabled to automatically optimize storage costs based on file access frequency |  |
| **High** | COST-02 | AWS EFS Cost Optimization Best Practices 2023 | Configure Lifecycle Management Policies | Set up lifecycle policies to transition infrequently accessed files to IA storage class | **IaC** - Define lifecycle management policies to move files to Infrequent Access (IA) storage after 30, 60, or 90 days |  |
| Medium | COST-03 | AWS EFS Cost Optimization Best Practices 2023 | Monitor and Optimize Performance Mode | Select appropriate performance mode based on workload requirements to avoid unnecessary costs | **Platform** - Use General Purpose mode for latency-sensitive workloads and Max I/O only when higher aggregate throughput is needed |  |
| Medium | COST-04 | AWS EFS Cost Optimization Best Practices 2023 | Right-size Throughput Mode | Choose between Bursting and Provisioned throughput modes based on actual performance requirements | **Platform** - Monitor CloudWatch metrics to determine if Provisioned Throughput is cost-effective compared to Bursting mode |  |
| Medium | COST-05 | AWS EFS Cost Optimization Best Practices 2023 | Implement Cost Monitoring and Alerting | Set up CloudWatch billing alerts and AWS Cost Explorer for EFS cost tracking | **Platform** - Configure billing alerts for EFS usage and create Cost Explorer reports to track storage class utilization |  |
| Low | COST-06 | AWS EFS Cost Optimization Best Practices 2023 | Optimize Regional Replication | Evaluate regional replication necessity and configure appropriate storage classes for replicated data | **IaC** - Configure replication destinations with appropriate storage classes and lifecycle policies to minimize cross-region costs |  |
| Low | COST-07 | AWS EFS Cost Optimization Best Practices 2023 | Regular Storage Utilization Review | Conduct periodic reviews of storage utilization and clean up unused files and directories | **User** - Implement regular audits of file system contents and establish data retention policies to remove obsolete data |  |

