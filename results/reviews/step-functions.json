{
    "service": "AWS Step Functions",
    "security": [
        {
            "name": "CSA Cloud Controls Matrix",
            "version": "v4.0.10",
            "controls": [
                {
                    "identifier": "IAM-01",
                    "title": "Identity and Access Management Policy and Procedures",
                    "severity": "Medium",
                    "description": "Establish, implement, communicate, and maintain identity and access management policies and procedures",
                    "implementation": {
                        "type": "User",
                        "description": "Develop and maintain organizational IAM policies for Step Functions, define roles and responsibilities for access management, and establish procedures for regular access reviews"
                    }
                },
                {
                    "identifier": "IVS-01",
                    "title": "Data Classification Policies and Procedures",
                    "severity": "Medium",
                    "description": "Establish, implement, communicate, and maintain data classification policies and procedures to identify and classify information assets",
                    "implementation": {
                        "type": "User",
                        "description": "Establish data classification policies for workflow data, define procedures for classifying information processed by Step Functions, and document data handling requirements based on classification levels"
                    }
                },
                {
                    "identifier": "EKM-01",
                    "title": "Encryption Key Management Policies and Procedures",
                    "severity": "High",
                    "description": "Establish, implement, communicate, and maintain encryption key management policies and procedures",
                    "implementation": {
                        "type": "User",
                        "description": "Define encryption key management policies for Step Functions data, establish key lifecycle procedures, and document key access and rotation requirements"
                    }
                },
                {
                    "identifier": "LOG-01",
                    "title": "Audit Logging Policy and Procedures",
                    "severity": "Medium",
                    "description": "Establish, implement, communicate, and maintain audit logging policies and procedures",
                    "implementation": {
                        "type": "User",
                        "description": "Develop audit logging policies for Step Functions activities, define log retention and review procedures, and establish incident response protocols based on log analysis"
                    }
                },
                {
                    "identifier": "IVS-08",
                    "title": "Network Security Policies and Procedures",
                    "severity": "Medium",
                    "description": "Establish, implement, communicate, and maintain network security policies and procedures",
                    "implementation": {
                        "type": "User",
                        "description": "Define network security policies for Step Functions communications, establish procedures for VPC endpoint configuration, and document network access control requirements"
                    }
                }
            ]
        },
        {
            "name": "NIST SP 800-53",
            "version": "Rev. 5",
            "controls": [
                {
                    "identifier": "AC-3",
                    "title": "Access Enforcement",
                    "severity": "High",
                    "description": "Enforce approved authorizations for logical access to information and system resources",
                    "implementation": {
                        "type": "IaC",
                        "description": "Implement resource-based policies, IAM roles with least privilege, and condition-based access controls for Step Functions"
                    }
                },
                {
                    "identifier": "SC-8",
                    "title": "Transmission Confidentiality and Integrity",
                    "severity": "High",
                    "description": "Protect the confidentiality and integrity of transmitted information",
                    "implementation": {
                        "type": "Platform",
                        "description": "Leverage AWS native encryption in transit, ensure HTTPS endpoints for integrations, and validate SSL/TLS configurations"
                    }
                },
                {
                    "identifier": "SC-28",
                    "title": "Protection of Information at Rest",
                    "severity": "High",
                    "description": "Protect the confidentiality and integrity of information at rest",
                    "implementation": {
                        "type": "IaC",
                        "description": "Enable encryption for Step Functions state data and logs using AWS KMS, configure appropriate encryption keys and access policies"
                    }
                },
                {
                    "identifier": "AU-2",
                    "title": "Event Logging",
                    "severity": "Medium",
                    "description": "Identify the types of events to be logged by the system",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure CloudWatch Logs for execution history, enable CloudTrail for API calls, and implement structured logging for workflow events"
                    }
                },
                {
                    "identifier": "SI-4",
                    "title": "System Monitoring",
                    "severity": "Medium",
                    "description": "Monitor the system to detect attacks and indicators of potential attacks",
                    "implementation": {
                        "type": "IaC",
                        "description": "Implement CloudWatch metrics and alarms, configure AWS Config rules for compliance monitoring, and set up security event detection"
                    }
                },
                {
                    "identifier": "CP-9",
                    "title": "System Backup",
                    "severity": "Low",
                    "description": "Conduct backups of system-level information contained in the system",
                    "implementation": {
                        "type": "User",
                        "description": "Version control state machine definitions, backup IAM policies and configurations, and maintain disaster recovery procedures"
                    }
                }
            ]
        },
        {
            "name": "AWS Foundational Security Best Practices",
            "version": "1.0",
            "controls": [
                {
                    "identifier": "StepFunctions.1",
                    "title": "Step Functions state machines should have logging turned on",
                    "severity": "Medium",
                    "description": "Step Functions state machines should have logging enabled to CloudWatch Logs for monitoring and troubleshooting",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure loggingConfiguration in state machine definition with appropriate log level (ALL, ERROR, FATAL, or OFF) and CloudWatch Logs destination"
                    }
                }
            ]
        },
        {
            "name": "AWS Security Hub",
            "version": "Latest",
            "controls": [
                {
                    "identifier": "StepFunctions.1",
                    "title": "Step Functions state machines should have logging turned on",
                    "severity": "Medium",
                    "description": "This control checks whether an AWS Step Functions state machine has logging turned on",
                    "implementation": {
                        "type": "IaC",
                        "description": "Enable logging in Step Functions state machine definition by configuring loggingConfiguration with appropriate CloudWatch Logs ARN and log level"
                    }
                }
            ]
        }
    ],
    "operational": [],
    "cost": [
        {
            "name": "AWS Step Functions Cost Optimization Best Practices",
            "version": "Latest",
            "controls": [
                {
                    "identifier": "COST-01",
                    "title": "Choose appropriate Step Functions workflow type",
                    "severity": "High",
                    "description": "Select Standard or Express workflows based on execution patterns and duration to optimize costs",
                    "implementation": {
                        "type": "User",
                        "description": "Use Express workflows for high-volume, short-duration workloads (under 5 minutes) and Standard workflows for long-running processes with complex error handling"
                    }
                },
                {
                    "identifier": "COST-02",
                    "title": "Optimize state transitions",
                    "severity": "High",
                    "description": "Minimize the number of state transitions to reduce Step Functions charges",
                    "implementation": {
                        "type": "User",
                        "description": "Combine multiple simple states into single states where possible, use parallel states efficiently, and avoid unnecessary pass states"
                    }
                },
                {
                    "identifier": "COST-03",
                    "title": "Implement efficient error handling",
                    "severity": "Medium",
                    "description": "Design error handling to minimize retry costs and failed state transitions",
                    "implementation": {
                        "type": "User",
                        "description": "Configure appropriate retry intervals and maximum attempts, implement circuit breaker patterns, and use exponential backoff for retries"
                    }
                },
                {
                    "identifier": "COST-04",
                    "title": "Monitor and analyze execution patterns",
                    "severity": "Medium",
                    "description": "Use CloudWatch metrics to monitor execution costs and identify optimization opportunities",
                    "implementation": {
                        "type": "IaC",
                        "description": "Set up CloudWatch dashboards for execution metrics, implement cost alerts for unexpected charges, and regularly review execution patterns"
                    }
                },
                {
                    "identifier": "COST-05",
                    "title": "Optimize payload sizes",
                    "severity": "Medium",
                    "description": "Minimize data passed between states to reduce execution costs and improve performance",
                    "implementation": {
                        "type": "User",
                        "description": "Use ResultPath and Parameters to filter data between states, store large payloads in S3 and pass references, and implement data compression where appropriate"
                    }
                },
                {
                    "identifier": "COST-06",
                    "title": "Use appropriate timeout values",
                    "severity": "Low",
                    "description": "Set reasonable timeout values to prevent long-running executions that incur unnecessary costs",
                    "implementation": {
                        "type": "User",
                        "description": "Configure TimeoutSeconds for states and workflows based on expected execution times, implement heartbeat timeouts for activities, and monitor timeout patterns"
                    }
                },
                {
                    "identifier": "COST-07",
                    "title": "Implement workflow versioning and cleanup",
                    "severity": "Low",
                    "description": "Manage state machine versions and clean up unused resources to avoid unnecessary storage costs",
                    "implementation": {
                        "type": "User",
                        "description": "Regularly review and delete unused state machine versions, implement automated cleanup procedures, and archive old execution history data"
                    }
                }
            ]
        }
    ]
}