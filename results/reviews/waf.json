{
  "service": "AWS Web Application Firewall (WAF)",
  "security": [
    {
      "name": "CSA Cloud Controls Matrix",
      "version": "v4.0.10",
      "controls": [
        {
          "identifier": "IAM-01",
          "title": "Entitlement",
          "severity": "Medium",
          "description": "Establish and maintain entitlement management policies for WAF resources",
          "implementation": {
            "type": "IaC",
            "description": "Implement IAM policies and roles with least privilege access to WAF resources using CloudFormation or Terraform templates"
          }
        },
        {
          "identifier": "IAM-02",
          "title": "User ID Credentials",
          "severity": "High",
          "description": "Ensure proper management of user identification and credentials for WAF access",
          "implementation": {
            "type": "Platform",
            "description": "Configure IAM users, groups, and roles with appropriate permissions for WAF administration through AWS IAM console"
          }
        },
        {
          "identifier": "DSI-01",
          "title": "Classification",
          "severity": "High",
          "description": "Classify and handle WAF configuration data and logs according to data sensitivity",
          "implementation": {
            "type": "User",
            "description": "Classify WAF configuration data and logs, implement appropriate handling procedures based on sensitivity levels"
          }
        },
        {
          "identifier": "GRM-06",
          "title": "Policy",
          "severity": "Medium",
          "description": "Establish and maintain governance policies for WAF management and operations",
          "implementation": {
            "type": "User",
            "description": "Document WAF governance policies, rule management procedures, and operational guidelines"
          }
        },
        {
          "identifier": "CEK-01",
          "title": "Encryption & Key Management",
          "severity": "High",
          "description": "Implement encryption for WAF logs and configuration data at rest and in transit",
          "implementation": {
            "type": "IaC",
            "description": "Enable encryption for WAF logs stored in S3, CloudWatch, and Kinesis Data Firehose destinations"
          }
        }
      ]
    },
    {
      "name": "NIST SP 800-53",
      "version": "Rev 5",
      "controls": [
        {
          "identifier": "AC-2",
          "title": "Account Management",
          "severity": "High",
          "description": "Manage accounts with access to WAF resources and configurations",
          "implementation": {
            "type": "Platform",
            "description": "Implement account lifecycle management for WAF administrators using AWS IAM with regular access reviews"
          }
        },
        {
          "identifier": "AC-3",
          "title": "Access Enforcement",
          "severity": "High",
          "description": "Enforce approved authorizations for logical access to WAF resources",
          "implementation": {
            "type": "IaC",
            "description": "Deploy resource-based policies and IAM policies that enforce least privilege access to WAF APIs and console"
          }
        },
        {
          "identifier": "SI-4",
          "title": "System Monitoring",
          "severity": "High",
          "description": "Monitor WAF for security events and potential threats",
          "implementation": {
            "type": "IaC",
            "description": "Configure CloudWatch metrics, alarms, and logging for WAF to detect and alert on security events"
          }
        },
        {
          "identifier": "AU-2",
          "title": "Event Logging",
          "severity": "High",
          "description": "Ensure comprehensive logging of WAF events and rule matches",
          "implementation": {
            "type": "IaC",
            "description": "Enable WAF logging to CloudWatch Logs, S3, or Kinesis Data Firehose with appropriate retention policies"
          }
        },
        {
          "identifier": "SC-7",
          "title": "Boundary Protection",
          "severity": "Medium",
          "description": "Implement boundary protection through WAF rules and policies",
          "implementation": {
            "type": "IaC",
            "description": "Deploy managed rule groups and custom rules to protect against OWASP Top 10 and other web application threats"
          }
        },
        {
          "identifier": "CM-8",
          "title": "System Component Inventory",
          "severity": "Medium",
          "description": "Maintain inventory of WAF components and configurations",
          "implementation": {
            "type": "User",
            "description": "Use AWS Config to track WAF resources and maintain inventory of Web ACLs, rule groups, and IP sets"
          }
        }
      ]
    },
    {
      "name": "AWS Foundational Security Standard",
      "version": "1.0.0",
      "controls": [
        {
          "identifier": "WAF.1",
          "title": "AWS WAF Classic Global Web ACL logging should be enabled",
          "severity": "Medium",
          "description": "Enable logging for AWS WAF Classic Global Web ACLs to monitor and analyze web requests",
          "implementation": {
            "type": "IaC",
            "description": "Configure logging destination for WAF Classic Web ACLs using CloudFormation or Terraform"
          }
        },
        {
          "identifier": "WAF.2",
          "title": "AWS WAF Classic Regional Web ACL logging should be enabled",
          "severity": "Medium",
          "description": "Enable logging for AWS WAF Classic Regional Web ACLs",
          "implementation": {
            "type": "IaC",
            "description": "Enable regional WAF logging through infrastructure templates with appropriate log destinations"
          }
        },
        {
          "identifier": "WAF.3",
          "title": "AWS WAF Classic Global Web ACL should have at least one rule or rule group",
          "severity": "Medium",
          "description": "Ensure WAF Classic Global Web ACLs contain protective rules",
          "implementation": {
            "type": "IaC",
            "description": "Deploy Web ACLs with managed rule groups or custom rules for application protection"
          }
        },
        {
          "identifier": "WAF.4",
          "title": "AWS WAF Classic Regional Web ACL should have at least one rule or rule group",
          "severity": "Medium",
          "description": "Ensure WAF Classic Regional Web ACLs contain protective rules",
          "implementation": {
            "type": "IaC",
            "description": "Implement regional Web ACLs with appropriate rule sets for regional application protection"
          }
        },
        {
          "identifier": "WAF.6",
          "title": "AWS WAF Global Web ACL logging should be enabled",
          "severity": "Medium",
          "description": "Enable logging for AWS WAF v2 Global Web ACLs",
          "implementation": {
            "type": "IaC",
            "description": "Configure logging for WAF v2 Global Web ACLs with CloudWatch Logs, S3, or Kinesis Data Firehose"
          }
        },
        {
          "identifier": "WAF.7",
          "title": "AWS WAF Regional Web ACL logging should be enabled",
          "severity": "Medium",
          "description": "Enable logging for AWS WAF v2 Regional Web ACLs",
          "implementation": {
            "type": "IaC",
            "description": "Enable comprehensive logging for regional WAF v2 Web ACLs through infrastructure automation"
          }
        },
        {
          "identifier": "WAF.8",
          "title": "AWS WAF Global Web ACL should have at least one rule or rule group",
          "severity": "Medium",
          "description": "Ensure WAF v2 Global Web ACLs contain protective rules",
          "implementation": {
            "type": "IaC",
            "description": "Deploy managed rule groups such as Core Rule Set, Known Bad Inputs, and application-specific rules"
          }
        },
        {
          "identifier": "WAF.10",
          "title": "AWS WAF Regional Web ACL should have at least one rule or rule group",
          "severity": "Medium",
          "description": "Ensure WAF v2 Regional Web ACLs contain protective rules",
          "implementation": {
            "type": "IaC",
            "description": "Implement regional Web ACLs with managed and custom rule groups for comprehensive protection"
          }
        }
      ]
    }
  ],
  "operational": [],
  "cost": [
    {
      "name": "AWS WAF Cost Optimization Best Practices",
      "version": "2023",
      "controls": [
        {
          "identifier": "COST-WAF-01",
          "title": "Optimize Web ACL Rule Evaluation",
          "severity": "High",
          "description": "Minimize Web Request Units (WRU) consumption by optimizing rule order and complexity",
          "implementation": {
            "type": "IaC",
            "description": "Order rules by likelihood of match and use efficient rule patterns to reduce WRU consumption"
          }
        },
        {
          "identifier": "COST-WAF-02",
          "title": "Right-size Managed Rule Groups",
          "severity": "High",
          "description": "Select only necessary managed rule groups to avoid unnecessary WRU charges",
          "implementation": {
            "type": "User",
            "description": "Regularly review and disable unused managed rule groups based on application requirements and threat landscape"
          }
        },
        {
          "identifier": "COST-WAF-03",
          "title": "Implement Intelligent Request Sampling",
          "severity": "Medium",
          "description": "Configure appropriate logging sampling rates to reduce storage costs while maintaining visibility",
          "implementation": {
            "type": "IaC",
            "description": "Configure sampling rates based on traffic volume and compliance requirements, typically 1-10% for high-volume applications"
          }
        },
        {
          "identifier": "COST-WAF-04",
          "title": "Optimize Log Storage and Retention",
          "severity": "Medium",
          "description": "Implement lifecycle policies for WAF logs to manage storage costs effectively",
          "implementation": {
            "type": "IaC",
            "description": "Configure S3 lifecycle policies to transition logs to IA and Glacier storage classes, and set appropriate retention periods"
          }
        },
        {
          "identifier": "COST-WAF-05",
          "title": "Monitor and Alert on WAF Costs",
          "severity": "Medium",
          "description": "Implement cost monitoring and alerting for WAF resource consumption",
          "implementation": {
            "type": "Platform",
            "description": "Set up CloudWatch billing alarms and AWS Cost Explorer reports to track WAF WRU consumption and associated costs"
          }
        },
        {
          "identifier": "COST-WAF-06",
          "title": "Regularly Review Rule Effectiveness",
          "severity": "Low",
          "description": "Conduct periodic reviews of rule effectiveness to remove unused or ineffective rules",
          "implementation": {
            "type": "User",
            "description": "Use WAF metrics and logs to identify rules with low match rates and evaluate their continued necessity"
          }
        },
        {
          "identifier": "COST-WAF-07",
          "title": "Consolidate Web ACLs Where Appropriate",
          "severity": "Low",
          "description": "Consolidate multiple Web ACLs with similar rule sets to reduce management overhead and costs",
          "implementation": {
            "type": "IaC",
            "description": "Evaluate opportunities to merge Web ACLs serving similar applications or environments while maintaining security boundaries"
          }
        }
      ]
    }
  ]
}

## Discrepancies Identified and Resolved:

### CSA Cloud Controls Matrix v4.0.10 Issues:
1. **IAM-01**: Title was incorrect - changed from "Identity and Access Management Policy and Procedures" to "Entitlement", severity reduced from High to Medium
2. **IAM-02**: Title was incorrect - changed from "User Access Provisioning" to "User ID Credentials"
3. **DSI-01**: Title was incorrect - changed from "Data Security and Information Lifecycle Management" to "Classification", implementation changed from IaC to User as this is primarily a governance activity
4. **STA-01**: Removed as this identifier doesn't exist in CSA CCM v4.0.10, replaced with GRM-06 "Policy"
5. **IVS-01**: Removed as this identifier doesn't exist in CSA CCM v4.0.10, added CEK-01 "Encryption & Key Management"

### AWS Security Hub Issues:
1. **Framework Name**: Changed from "AWS Security Hub" to "AWS Foundational Security Standard" - AWS Security Hub is a service that aggregates findings, not a compliance framework itself
2. **Removed duplicate WAF controls**: AWS Security Hub uses the same control identifiers as AWS Foundational Security Standard, so the separate section was redundant and consolidated

### NIST SP 800-53 and AWS Foundational Security Standard:
- These sections were already accurate and required no changes

The corrected JSON now properly aligns control identifiers with their actual framework definitions and removes redundant sections.