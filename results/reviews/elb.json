{
    "service": "AWS Elastic Load Balancer",
    "security": [
        {
            "name": "NIST 800-53",
            "version": "Rev 5",
            "controls": [
                {
                    "identifier": "AC-3",
                    "title": "Access Enforcement",
                    "severity": "HIGH",
                    "description": "Enforce approved authorizations for logical access to information and system resources in accordance with applicable access control policies",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure IAM policies and roles with least privilege access to ELB resources using resource-based policies and condition statements"
                    }
                },
                {
                    "identifier": "SC-7",
                    "title": "Boundary Protection",
                    "severity": "HIGH",
                    "description": "Monitor and control communications at the external boundary of the system and at key internal boundaries within the system",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure security groups and NACLs to restrict traffic, implement WAF rules, and use internal load balancers for private traffic. Deploy managed interface endpoints for boundary protection"
                    }
                },
                {
                    "identifier": "SC-8",
                    "title": "Transmission Confidentiality and Integrity",
                    "severity": "HIGH",
                    "description": "Protect the confidentiality and integrity of transmitted information",
                    "implementation": {
                        "type": "IaC",
                        "description": "Enable SSL/TLS termination on ALB/NLB with strong cipher suites and redirect HTTP to HTTPS"
                    }
                },
                {
                    "identifier": "AU-2",
                    "title": "Event Logging",
                    "severity": "MEDIUM",
                    "description": "Identify the types of events that the system is capable of logging in support of the audit function",
                    "implementation": {
                        "type": "IaC",
                        "description": "Enable access logging to S3 bucket and configure CloudTrail for ELB API calls"
                    }
                },
                {
                    "identifier": "SI-4",
                    "title": "System Monitoring",
                    "severity": "MEDIUM",
                    "description": "Monitor the system to detect attacks and indicators of potential attacks in accordance with the organization's monitoring objectives",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure CloudWatch metrics and alarms for ELB performance and security events, implement intrusion detection capabilities"
                    }
                },
                {
                    "identifier": "CP-2",
                    "title": "Contingency Plan",
                    "severity": "MEDIUM",
                    "description": "Develop a contingency plan for the system that identifies essential mission and business functions and associated contingency requirements",
                    "implementation": {
                        "type": "User",
                        "description": "Deploy ELB across multiple AZs and implement cross-region disaster recovery procedures"
                    }
                }
            ]
        },
        {
            "name": "CSA Cloud Controls Matrix",
            "version": "v4.0",
            "controls": [
                {
                    "identifier": "IAM-01",
                    "title": "Identity and Access Management Policy and Procedures",
                    "severity": "HIGH",
                    "description": "Policies and procedures shall be established, and supporting business processes and technical measures implemented, for identity and access management for all users and objects with access to organizational assets within the scope of the system being audited",
                    "implementation": {
                        "type": "User",
                        "description": "Implement IAM policies with least privilege for ELB management and establish regular access reviews"
                    }
                },
                {
                    "identifier": "IVS-02",
                    "title": "Vulnerability Management",
                    "severity": "HIGH",
                    "description": "Vulnerabilities shall be assessed and remediated according to the following requirements: timely detection, assessment, and remediation of vulnerabilities",
                    "implementation": {
                        "type": "User",
                        "description": "Regularly assess ELB configurations using AWS Config rules and Security Hub findings for vulnerability management"
                    }
                },
                {
                    "identifier": "DSI-01",
                    "title": "Data Classification",
                    "severity": "HIGH",
                    "description": "Data and objects shall be classified according to classification scheme and handling requirements according to applicable legal, statutory, or regulatory compliance obligations",
                    "implementation": {
                        "type": "User",
                        "description": "Tag ELB resources with appropriate data classification labels and implement corresponding security controls"
                    }
                },
                {
                    "identifier": "EKM-01",
                    "title": "Entitlements Management",
                    "severity": "HIGH",
                    "description": "Procedures shall be established, documented, approved, communicated, applied, evaluated and maintained for provisioning and de-provisioning of user account entitlements",
                    "implementation": {
                        "type": "User",
                        "description": "Establish procedures for managing ELB access entitlements and implement regular entitlement reviews"
                    }
                },
                {
                    "identifier": "IPY-01",
                    "title": "Interoperability Agreements",
                    "severity": "MEDIUM",
                    "description": "Interoperability agreements shall be established with partners and third-party providers",
                    "implementation": {
                        "type": "User",
                        "description": "Establish agreements for third-party integrations with ELB services and configure appropriate access controls"
                    }
                },
                {
                    "identifier": "TVM-01",
                    "title": "Anti-Virus / Malicious Software",
                    "severity": "MEDIUM",
                    "description": "Anti-virus and anti-malware solutions shall be implemented",
                    "implementation": {
                        "type": "Platform",
                        "description": "AWS manages anti-malware protection for the ELB service infrastructure"
                    }
                }
            ]
        },
        {
            "name": "AWS Foundational Security Best Practices",
            "version": "1.0.0",
            "controls": [
                {
                    "identifier": "ELB.2",
                    "title": "Classic Load Balancers with SSL/HTTPS listeners should use predefined security policies that have strong configurations",
                    "severity": "MEDIUM",
                    "description": "This control checks whether your Classic Load Balancer SSL/HTTPS listeners are using a predefined security policy",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure CLB with predefined security policies like ELBSecurityPolicy-TLS-1-2-2017-01 or newer"
                    }
                },
                {
                    "identifier": "ELB.3",
                    "title": "Classic Load Balancer listeners should be configured with HTTPS or TLS termination",
                    "severity": "HIGH",
                    "description": "This control checks whether your Classic Load Balancer listeners are configured with HTTPS or TLS termination",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure CLB listeners with HTTPS or TLS termination using valid SSL certificates"
                    }
                },
                {
                    "identifier": "ELB.4",
                    "title": "Application Load Balancers should be configured to drop HTTP headers",
                    "severity": "MEDIUM",
                    "description": "This control evaluates whether Application Load Balancers are configured to drop invalid HTTP headers",
                    "implementation": {
                        "type": "IaC",
                        "description": "Enable routing.http.drop_invalid_header_fields.enabled attribute on ALB"
                    }
                },
                {
                    "identifier": "ELB.5",
                    "title": "Application and Network Load Balancers should have logging enabled",
                    "severity": "MEDIUM",
                    "description": "This control checks whether Application Load Balancers and Network Load Balancers have logging enabled",
                    "implementation": {
                        "type": "IaC",
                        "description": "Enable access logging to S3 bucket with appropriate bucket policies and lifecycle management"
                    }
                },
                {
                    "identifier": "ELB.6",
                    "title": "Application Load Balancer deletion protection should be enabled",
                    "severity": "LOW",
                    "description": "This control checks whether an Application Load Balancer has deletion protection enabled",
                    "implementation": {
                        "type": "IaC",
                        "description": "Set deletion_protection attribute to true in ALB configuration"
                    }
                },
                {
                    "identifier": "ELB.7",
                    "title": "Classic Load Balancers should have connection draining enabled",
                    "severity": "LOW",
                    "description": "This control checks whether connection draining is enabled for Classic Load Balancers",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure connection draining with appropriate timeout values on CLB"
                    }
                }
            ]
        },
        {
            "name": "AWS Security Hub",
            "version": "2023.1",
            "controls": [
                {
                    "identifier": "[ELB.2]",
                    "title": "Classic Load Balancers with SSL/HTTPS listeners should use predefined security policies that have strong configurations",
                    "severity": "MEDIUM",
                    "description": "This control checks whether your Classic Load Balancer SSL/HTTPS listeners are using a predefined security policy with strong configurations",
                    "implementation": {
                        "type": "IaC",
                        "description": "Apply security policies like ELBSecurityPolicy-TLS-1-2-2017-01 or ELBSecurityPolicy-FS-1-2-Res-2020-10"
                    }
                },
                {
                    "identifier": "[ELB.3]",
                    "title": "Classic Load Balancer listeners should be configured with HTTPS or TLS termination",
                    "severity": "HIGH",
                    "description": "This control checks whether your Classic Load Balancer listeners are configured with HTTPS or TLS termination",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure HTTPS/TLS listeners on CLB with valid SSL certificates from ACM"
                    }
                },
                {
                    "identifier": "[ELB.4]",
                    "title": "Application Load Balancers should be configured to drop HTTP headers",
                    "severity": "MEDIUM",
                    "description": "This control evaluates whether Application Load Balancers are configured to drop invalid HTTP headers",
                    "implementation": {
                        "type": "IaC",
                        "description": "Enable routing.http.drop_invalid_header_fields.enabled attribute on ALB"
                    }
                },
                {
                    "identifier": "[ELB.5]",
                    "title": "Application and Network Load Balancers should have logging enabled",
                    "severity": "MEDIUM",
                    "description": "This control checks whether Application Load Balancers and Network Load Balancers have logging enabled",
                    "implementation": {
                        "type": "IaC",
                        "description": "Enable access logging to S3 bucket with appropriate bucket policies and lifecycle management"
                    }
                },
                {
                    "identifier": "[ELB.6]",
                    "title": "Application Load Balancer deletion protection should be enabled",
                    "severity": "LOW",
                    "description": "This control checks whether an Application Load Balancer has deletion protection enabled",
                    "implementation": {
                        "type": "IaC",
                        "description": "Set deletion_protection attribute to true in ALB configuration"
                    }
                },
                {
                    "identifier": "[ELB.12]",
                    "title": "Application Load Balancers should be configured with defensive or strictest desync mitigation mode",
                    "severity": "MEDIUM",
                    "description": "This control checks whether an Application Load Balancer is configured with defensive or strictest desync mitigation mode",
                    "implementation": {
                        "type": "IaC",
                        "description": "Set routing.http.desync_mitigation_mode to defensive or strictest on ALB"
                    }
                }
            ]
        }
    ],
    "operational": [],
    "cost": [
        {
            "name": "AWS ELB Cost Optimization Best Practices",
            "version": "2024",
            "controls": [
                {
                    "identifier": "COST-01",
                    "title": "Right-size Load Balancer Type",
                    "severity": "HIGH",
                    "description": "Choose the appropriate load balancer type based on actual requirements to avoid unnecessary costs",
                    "implementation": {
                        "type": "User",
                        "description": "Evaluate traffic patterns and requirements to select between ALB, NLB, and CLB based on feature needs and cost structure"
                    }
                },
                {
                    "identifier": "COST-02",
                    "title": "Optimize Load Balancer Capacity Units (LCU)",
                    "severity": "HIGH",
                    "description": "Monitor and optimize LCU usage to reduce costs for ALB and NLB",
                    "implementation": {
                        "type": "User",
                        "description": "Monitor CloudWatch metrics for processed bytes, active connections, new connections, and rule evaluations to optimize LCU consumption"
                    }
                },
                {
                    "identifier": "COST-03",
                    "title": "Consolidate Load Balancers",
                    "severity": "MEDIUM",
                    "description": "Consolidate multiple load balancers where possible to reduce fixed hourly costs",
                    "implementation": {
                        "type": "IaC",
                        "description": "Use host-based and path-based routing rules to serve multiple applications from a single ALB instead of deploying separate load balancers"
                    }
                },
                {
                    "identifier": "COST-04",
                    "title": "Optimize Cross-Zone Load Balancing",
                    "severity": "MEDIUM",
                    "description": "Evaluate cross-zone load balancing settings to optimize data transfer costs",
                    "implementation": {
                        "type": "IaC",
                        "description": "Disable cross-zone load balancing for NLB if traffic distribution allows, and consider regional traffic patterns for ALB"
                    }
                },
                {
                    "identifier": "COST-05",
                    "title": "Implement Efficient Health Checks",
                    "severity": "LOW",
                    "description": "Optimize health check frequency and target to reduce unnecessary load and potential costs",
                    "implementation": {
                        "type": "IaC",
                        "description": "Configure appropriate health check intervals and paths to minimize resource consumption while maintaining reliability"
                    }
                },
                {
                    "identifier": "COST-06",
                    "title": "Monitor and Optimize Idle Load Balancers",
                    "severity": "MEDIUM",
                    "description": "Identify and remove unused or underutilized load balancers",
                    "implementation": {
                        "type": "User",
                        "description": "Set up CloudWatch alarms and regular reviews to identify load balancers with minimal traffic and evaluate their necessity"
                    }
                },
                {
                    "identifier": "COST-07",
                    "title": "Optimize Target Group Configuration",
                    "severity": "LOW",
                    "description": "Configure target groups efficiently to minimize processing overhead",
                    "implementation": {
                        "type": "IaC",
                        "description": "Optimize target group size, deregistration delay, and connection draining settings to reduce unnecessary resource consumption"
                    }
                },
                {
                    "identifier": "COST-08",
                    "title": "Leverage Reserved Capacity",
                    "severity": "LOW",
                    "description": "Consider reserved capacity options for predictable, long-term load balancer usage",
                    "implementation": {
                        "type": "User",
                        "description": "Analyze usage patterns and consider AWS Savings Plans or other commitment-based pricing models for consistent workloads"
                    }
                }
            ]
        }
    ]
}

## Summary of Changes Made:

### NIST 800-53 Rev 5:
1. **AC-3**: Enhanced description to include "in accordance with applicable access control policies"
2. **SC-7**: Updated description to include "key internal boundaries within the system" and enhanced implementation
3. **AU-2**: Changed severity from HIGH to MEDIUM and updated description to include "in support of the audit function"
4. **SI-4**: Enhanced description and implementation to include "intrusion detection capabilities"

### CSA Cloud Controls Matrix:
1. **Version**: Corrected from "v5.0" to "v4.0" (current version)
2. **IVS-01**: Replaced with **IVS-02** (Vulnerability Management) as IVS-01 is not Clock Synchronization
3. **EKM-01**: Changed from "Encryption Key Management" to "Entitlements Management" with corrected description
4. **IPY-01**: Updated to "Interoperability Agreements" with appropriate implementation
5. **TVM-01**: Changed implementation from User to Platform responsibility

### AWS Foundational Security Best Practices:
1. **ELB.3**: Corrected title and description - this control is about HTTPS/TLS termination, not HTTP to HTTPS redirect

### AWS Security Hub:
1. **Identifiers**: Added proper bracket formatting (e.g., [ELB.2] instead of ELB.2)
2. **ELB.1**: Replaced with [ELB.3] as ELB.1 doesn't exist in Security Hub
3. **ELB.8**: Replaced with [ELB.2] (duplicate removal)
4. **ELB.9, ELB.10, ELB.11**: Removed as these don't exist in the actual Security Hub standard
5. **ELB.12**: Updated severity from LOW to MEDIUM and corrected identifier format

The changes align the controls with their actual framework definitions and correct implementation guidance.